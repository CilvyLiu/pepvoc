<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Unit 5: Colours | Junior Explorer</title>
    <style>
        :root { --primary: #9B59B6; --accent: #FF6B6B; --bg: #F9F5FF; --card-bg: #FFFFFF; }
        body { 
            font-family: 'Segoe UI', system-ui, sans-serif; background: var(--bg); color: #333; margin: 0; padding: 0;
            -webkit-tap-highlight-color: transparent;
        }

        .status-bar {
            position: sticky; top: 0; z-index: 1000;
            background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px);
            border-bottom: 4px solid var(--primary); padding: 15px 20px;
            display: flex; align-items: center; justify-content: space-between;
        }
        #word-display { font-size: 28px; font-weight: 900; color: var(--primary); text-transform: capitalize; }
        #logic-display { font-size: 14px; color: #666; margin-top: 2px; }

        .vocab-grid { 
            display: grid; grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); 
            gap: 12px; padding: 20px; 
        }
        
        .card {
            background: var(--card-bg); border-radius: 20px; padding: 18px;
            text-align: center; cursor: pointer; border: 3px solid #F3E5FF;
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 6px 0 #DED0EA;
        }
        .card:active { transform: translateY(4px); box-shadow: 0 2px 0 #DED0EA; }
        .card.active { border-color: var(--primary); background: #F8F0FF; transform: scale(1.05); }

        .word-txt { font-size: 18px; font-weight: bold; color: #2D3436; display: block; }
        .ipa-txt { font-size: 11px; color: #A29BFE; font-family: Arial; }
        
        .back-btn { background: #2D3436; color: white; border: none; padding: 10px 18px; border-radius: 50px; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>

    <div class="status-bar">
        <div class="info">
            <div id="word-display">ğŸ¨ Colour Lab</div>
            <div id="logic-display">æ¬¢è¿æ¥åˆ°è‰²å½©å®éªŒå®¤ï¼Œç‚¹å‡»é¢œè‰²å¬è¯»éŸ³</div>
        </div>
        <button class="back-btn" onclick="location.href='../index.html'">è¿”å›</button>
    </div>

    <div class="vocab-grid" id="container">ğŸ“¡ æ­£åœ¨åŒæ­¥è‰²å½©æ•°æ®...</div>

    <script>
        const wordEl = document.getElementById('word-display');
        const logicEl = document.getElementById('logic-display');
        const container = document.getElementById('container');

        // --- æ ¸å¿ƒï¼šè·¨å¹³å°éŸ³é¢‘é¢„çƒ­ (é’ˆå¯¹ iOS/å®‰å“) ---
        function unlockAudio() {
            const msg = new SpeechSynthesisUtterance("");
            window.speechSynthesis.speak(msg);
            // ç§»é™¤ç›‘å¬ï¼Œé˜²æ­¢é‡å¤è§¦å‘
            document.removeEventListener('touchstart', unlockAudio);
            document.removeEventListener('click', unlockAudio); 
        }
        // è‹¹æœæ‰‹æœºå¢åŠ  click ç›‘å¬æ›´ç¨³å¦¥
        document.addEventListener('touchstart', unlockAudio);
        document.addEventListener('click', unlockAudio);
        
        // --- æ ¸å¿ƒï¼šæ ‡å‡†è‹±éŸ³æ’­æ”¾ (å¼ºåˆ¶ Type 2) ---
        function playUK(text) {
            // å¼ºåˆ¶ä½¿ç”¨ type=2 (è‹±éŸ³)
            const audioUrl = `https://dict.youdao.com/dictvoice?audio=${encodeURIComponent(text)}&type=2`;
            const audio = new Audio(audioUrl);
            
            const playPromise = audio.play();
            if (playPromise !== undefined) {
                playPromise.catch(() => {
                    // å¦‚æœæ¥å£è¢«å±è”½æˆ–ç¦»çº¿ï¼Œå¼ºåˆ¶è°ƒç”¨ç³»ç»Ÿ en-GB
                    window.speechSynthesis.cancel();
                    const speech = new SpeechSynthesisUtterance(text);
                    speech.lang = 'en-GB'; 
                    speech.rate = 0.8; 
                    window.speechSynthesis.speak(speech);
                });
            }
        }
        function activate(item, el) {
            wordEl.innerText = item.word;
            logicEl.innerText = `${item.chinese} | ${item.logic}`;
            wordEl.style.transform = "scale(1.1)";
            setTimeout(() => wordEl.style.transform = "scale(1)", 200);
            document.querySelectorAll('.card').forEach(c => c.classList.remove('active'));
            el.classList.add('active');
            playUK(item.word);
        }

        fetch('data.json')
            .then(res => res.json())
            .then(data => {
                container.innerHTML = "";
                data.forEach(item => {
                    const card = document.createElement('div');
                    card.className = 'card';
                    card.onclick = () => activate(item, card);
                    card.innerHTML = `<span class="word-txt">${item.word}</span><span class="ipa-txt">${item.ipa}</span>`;
                    container.appendChild(card);
                });
            });
    </script>
</body>
</html>
